<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Lazyloadingï¼ŒiOSï¼Œè€ç‹ï¼ŒLazy.wiki">
    <meta name="description" content="iOSå¼€å‘è€…Lazyloadingä¸ªäººç«™ï¼Œéšå¿ƒå‘æŒ¥ï¼Œè‡ªç”±å†™ä½œã€‚">
    <meta name="author" content="Lazyloading">
    
    <title>
        
            iOS15æ¨é€åå°è¯­éŸ³æ’­æŠ¥æ¢ç´¢ |
        
        Lazyloading
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/favicon.jpg">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/css/font-awesome.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"lazy.wiki","root":"/","language":"zh-CN","path":"search.json"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true},"style":{"primary_color":"#003366","avatar":"/images/favicon.jpg","favicon":"/images/favicon.jpg","article_img_align":"center","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":false,"scale":true},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"æˆ‘ä¸æˆ‘å‘¨æ—‹ä¹…ï¼Œå®åšæˆ‘......"},"scroll":{"progress_bar":{"enable":false},"percent":{"enable":true}}},"local_search":{"enable":true,"preload":false},"code_copy":{"enable":true,"style":"default"},"pjax":{"enable":true},"lazyload":{"enable":true},"version":"3.4.5"};
    KEEP.language_ago = {"second":"%s ç§’å‰","minute":"%s åˆ†é’Ÿå‰","hour":"%s å°æ—¶å‰","day":"%s å¤©å‰","week":"%s å‘¨å‰","month":"%s ä¸ªæœˆå‰","year":"%s å¹´å‰"};
  </script>
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Lazyloadingçš„åšå®¢" type="application/atom+xml">
</head>


<body>
<div class="progress-bar-container">
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fas fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
                <a class="logo-image" href="/">
                    <img src="/images/favicon.jpg">
                </a>
            
            <a class="logo-title" href="/">
                Lazyloading
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                é¦–é¡µ
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                å½’æ¡£
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                åˆ†ç±»
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                æ ‡ç­¾
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/links"
                            >
                                å‹é“¾
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">é¦–é¡µ</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">å½’æ¡£</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">åˆ†ç±»</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">æ ‡ç­¾</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/links">å‹é“¾</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">iOS15æ¨é€åå°è¯­éŸ³æ’­æŠ¥æ¢ç´¢</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/favicon.jpg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">Lazyloading</span>
                        
                            <span class="author-label">Lv3</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;
        <span class="pc">2021-12-19 14:38:57</span>
        <span class="mobile">2021-12-19 14:38</span>
    </span>
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/%E5%BC%80%E5%8F%91/">å¼€å‘</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/iOS/">iOS</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <p>meta <meta name="referrer" content="no-referrer" /></p>
<h3 id="å‰è¨€">å‰è¨€</h3>
<p>å‰ä¸€æ®µæ—¶é—´å…¬å¸é¡¹ç›®æœ‰ä¸ªæ¨é€å†…å®¹è¯­éŸ³æ’­æŠ¥çš„éœ€æ±‚ï¼Œå½“æ—¶è®©åšæŠ€æœ¯è°ƒç ”ï¼Œç®€å•æœäº†ä¸‹ç›¸å…³çš„æ–‡ç« å’Œèµ„æ–™ï¼Œè°ƒç ”ä¸€åŠçš„æ—¶å€™çªç„¶æ¥äº†ä¼˜å…ˆçº§æ›´é«˜çš„éœ€æ±‚ï¼Œæç½®äº†ï¼Œè¿™ä¸¤å¤©ç©ºä¸‹æ¥ï¼Œæ‰€ä»¥ç»§ç»­çœ‹ï¼Œå¹¶ä¸”æœ‰äº†å¯è¡Œçš„æ–¹æ¡ˆã€‚</p>
<p>è°ƒç ”åå‘ç°è¿™ä¸ªéœ€æ±‚ç”¨åˆ°<strong>Notification Service Extension</strong>ï¼Œç½‘ä¸Šæœ‰ä¸€äº›æ–‡ç« è®²è¿™ä¸ªéœ€æ±‚çš„å®ç°ï¼Œä½†æ˜¯ç»å¤§å¤šæ•°è®²çš„æ–¹æ¡ˆç°åœ¨å·²ç»ä¸é€‚ç”¨äº†æˆ–è€…æ˜¯åªæä¾›ä¸€ä¸ªå¤§è‡´çš„æ€è·¯æ²¡æœ‰å…·ä½“çš„å®ç°ï¼Œæ‰€ä»¥æŠŠæˆ‘å®ç°è¿™ä¸ªéœ€æ±‚çš„è¿‡ç¨‹è®°å½•åˆ†äº«å‡ºæ¥</p>
<h3 id="Notification-Service-Extension">Notification Service Extension</h3>
<p><code>Notification Service Extension</code>iOS10ä¹‹åæ‰èƒ½ä½¿ç”¨ï¼Œå¦‚æœè¦æƒ³ä½¿ç”¨<code>Notification Service Extension</code>å¯¹é€šçŸ¥å†…å®¹è¿›è¡Œæ›´æ”¹ï¼Œéœ€è¦åœ¨æ¨é€ä¸­å¢åŠ <code>mutable-content</code>å­—æ®µå¹¶å°†å€¼è®¾ç½®ä¸º<code>true</code>ï¼Œä½¿ç”¨é€šçŸ¥æ‰©å±•åæ¨é€çš„å¤„ç†æµç¨‹å¦‚å›¾æ‰€ç¤º<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://upload-images.jianshu.io/upload_images/2334192-0078503af33c455b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"
                      alt="image"
                ><br>
åˆ›å»ºæ­¥éª¤å¦‚ä¸‹å›¾æ‰€ç¤º<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://upload-images.jianshu.io/upload_images/2334192-f1a6486c00c4936f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"
                      alt="image"
                ><br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://upload-images.jianshu.io/upload_images/2334192-2438899df962bf8f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"
                      alt="image"
                ></p>
<p>å®Œæˆåä¼šåœ¨é¡¹ç›®ä¸­ç”Ÿæˆä¸€ä¸ªtargetå’Œå¯¹åº”çš„æ–‡ä»¶å¤¹ï¼Œæˆ‘ä»¬çš„ä»£ç å°±è¦å¸è½½<code>NotificationService.m</code>ä¸­</p>
<p><code>NotificationService.m</code>æ–‡ä»¶å†…éƒ¨æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªæ–¹æ³•ä¸­å¯¹é€šçŸ¥å†…å®¹è¿›è¡Œä¿®æ”¹</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Call contentHandler with the modified notification content to deliver. If the handler is not called before the service&#x27;s time expires then the unmodified notification will be delivered.</span></span><br><span class="line"><span class="comment">// You are expected to override this method to implement push notification modification.</span></span><br><span class="line">- (<span class="keyword">void</span>)didReceiveNotificationRequest:(UNNotificationRequest *)request withContentHandler:(<span class="keyword">void</span> (^)(UNNotificationContent *contentToDeliver))contentHandler</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªæ–¹æ³•ä¸­åšé€šçŸ¥æ‰©å±•ç»ˆæ­¢å‰çš„å…œåº•å¤„ç†</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Will be called just before this extension is terminated by the system. You may choose whether to override this method.</span></span><br><span class="line">- (<span class="keyword">void</span>)serviceExtensionTimeWillExpire;</span><br></pre></td></tr></table></figure>
<p>åˆ°æ­¤<code>Notification Service Extension</code>åˆ›å»ºå®Œæˆ</p>
<h3 id="æ’­æŠ¥æ¢ç´¢">æ’­æŠ¥æ¢ç´¢</h3>
<h4 id="ç³»ç»Ÿè¯­éŸ³åˆæˆ">ç³»ç»Ÿè¯­éŸ³åˆæˆ</h4>
<p>ç³»ç»Ÿæä¾›çš„æœ‰æ–‡å­—è½¬è¯­éŸ³æ’­æŠ¥çš„æ–¹æ³•ï¼Œæˆ‘ä»¬åœ¨æ”¶åˆ°æ¨é€åå¯ä»¥ä¼ å…¥æ–‡å­—ç›´æ¥æ’­æŠ¥å‡ºè¯­éŸ³</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)didReceiveNotificationRequest:(UNNotificationRequest *)request withContentHandler:(<span class="keyword">void</span> (^)(UNNotificationContent * _Nonnull))contentHandler &#123;</span><br><span class="line">    <span class="keyword">self</span>.contentHandler = contentHandler;</span><br><span class="line">    <span class="keyword">self</span>.bestAttemptContent = [request.content mutableCopy];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Modify the notification content here...</span></span><br><span class="line">    <span class="keyword">self</span>.bestAttemptContent.title = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@&quot;%@ [modified]&quot;</span>, <span class="keyword">self</span>.bestAttemptContent.title];</span><br><span class="line">    <span class="built_in">NSString</span> *content = <span class="keyword">self</span>.bestAttemptContent.userInfo[<span class="string">@&quot;aps&quot;</span>][<span class="string">@&quot;alert&quot;</span>][<span class="string">@&quot;body&quot;</span>];</span><br><span class="line">    <span class="built_in">AVSpeechUtterance</span> *utterance = [<span class="built_in">AVSpeechUtterance</span> speechUtteranceWithString:content];</span><br><span class="line">    <span class="built_in">AVSpeechSynthesisVoice</span> *voice = [<span class="built_in">AVSpeechSynthesisVoice</span> voiceWithLanguage:<span class="string">@&quot;zh-CN&quot;</span>];</span><br><span class="line">    utterance.voice = voice;</span><br><span class="line">    <span class="built_in">AVSpeechSynthesizer</span> *synth = [[<span class="built_in">AVSpeechSynthesizer</span> alloc] init];</span><br><span class="line">    [synth speakUtterance:utterance];</span><br><span class="line">    <span class="keyword">self</span>.contentHandler(<span class="keyword">self</span>.bestAttemptContent);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç½‘ä¸Šå¤§éƒ¨åˆ†æ–‡ç« ä¹Ÿä¼šè¿™ä¹ˆå†™ï¼Œä½†æ˜¯ç°åœ¨å®é™…åº”ç”¨ä¸­åŸºæœ¬ä¸ä¼šç”¨è¿™ä¸ªæ–¹æ¡ˆåŸå› æœ‰ä¸¤ä¸ªï¼š</p>
<ol>
<li><strong>iOS12.1</strong>ä¹‹åç³»ç»Ÿé™åˆ¶äº†åœ¨æ‰©å±•é‡Œè¿›è¡Œæ’­æŠ¥çš„èƒ½åŠ›ï¼Œæ‰€ä»¥æ­¤æ–¹æ¡ˆåªèƒ½ç”¨åœ¨<strong>iOS12.1</strong>ä¹‹å‰</li>
<li>è¯­éŸ³ç”Ÿç¡¬ï¼Œå¹¶ä¸”å¤šéŸ³å­—å’Œè‹±æ–‡å­—æ¯åœ¨æ±‰è¯­è¯­å¢ƒä¸‹ç»å¸¸è¯»é”™ï¼Œæ¯”å¦‚å­—æ¯<code>E</code>ä¼šè¯»æˆ<code>é¢</code>çš„éŸ³(è¿™ä¸ªæˆ‘åŒä¸€å¥—ä»£ç åœ¨ä¸åŒè®¾å¤‡ä¸Šè¯»éŸ³ä¸ä¸€è‡´ï¼Œæ²¡æ‰¾åˆ°åŸå› )ï¼Œè¿˜æ˜¯ä¸‰æ–¹æœåŠ¡æ•ˆæœå¥½ç‚¹&gt;_&lt;!</li>
</ol>
<h4 id="å†…ç½®æœ¬åœ°éŸ³é¢‘">å†…ç½®æœ¬åœ°éŸ³é¢‘</h4>
<p>åæ¥å°±æƒ³ï¼Œä¸èƒ½è¯­éŸ³åˆæˆï¼Œé‚£æ’­æ”¾æœ¬åœ°è¯­éŸ³å‘¢ï¼Ÿ</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)didReceiveNotificationRequest:(UNNotificationRequest *)request withContentHandler:(<span class="keyword">void</span> (^)(UNNotificationContent * _Nonnull))contentHandler &#123;</span><br><span class="line">    <span class="keyword">self</span>.contentHandler = contentHandler;</span><br><span class="line">    <span class="keyword">self</span>.bestAttemptContent = [request.content mutableCopy];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Modify the notification content here...</span></span><br><span class="line">    <span class="keyword">self</span>.bestAttemptContent.title = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@&quot;%@ [modified]&quot;</span>, <span class="keyword">self</span>.bestAttemptContent.title];</span><br><span class="line">    <span class="built_in">NSString</span> * voiceType = <span class="keyword">self</span>.bestAttemptContent.userInfo[<span class="string">@&quot;voiceType&quot;</span>];</span><br><span class="line">    UNNotificationSound * sound = [UNNotificationSound soundNamed:[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@&quot;%@.mp3&quot;</span>,voiceType]];</span><br><span class="line">    <span class="keyword">self</span>.bestAttemptContent.sound = sound;</span><br><span class="line">    <span class="keyword">self</span>.contentHandler(<span class="keyword">self</span>.bestAttemptContent);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰©å±•ç±»ä¸­æœ‰ä¸ª<code>bestAttemptContent</code>å±æ€§ï¼Œä»–æ˜¯<code>UNMutableNotificationContent</code>ç±»å‹ï¼Œæˆ‘ä»¬åœ¨ä¿®æ”¹æ¨é€å†…å®¹æ—¶ä¹Ÿæ˜¯å¯¹å®ƒè¿›è¡Œä¿®æ”¹ï¼Œè€Œæ’­æ”¾æœ¬åœ°è¯­éŸ³å°±æ˜¯ä¿®æ”¹å®ƒçš„<code>sound</code>å±æ€§ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™äº§å“è·³å‡ºæ¥äº†ï¼Œè¯´å¯¹è¿™æ ·çš„å®ç°ä¸å¤ªæ»¡æ„ï¼Œå¤ªæ­»æ¿ï¼Œåªèƒ½æ’­æ”¾å›ºå®šçš„éŸ³é¢‘ä¸å¤Ÿçµæ´»ğŸ˜‚ï¼Œæ²¡åŠæ³•åªèƒ½ç»§ç»­çœ‹</p>
<p>ç„¶åå°±æƒ³æŠŠæ’­æŠ¥å†…å®¹æ‹†å¼€ï¼Œæœ¬åœ°å†…ç½®å‡ æ®µè¯­éŸ³ï¼Œæ ¹æ®æ¨é€å†…å®¹è¿›è¡Œæ‹¼æ¥ï¼Œç„¶åä¿®æ”¹<code>sound</code>è¿›è¡Œæ’­æŠ¥ï¼Œæˆ‘å…ˆéšä¾¿æ‰¾äº†ä¸¤æ®µæ¯”è¾ƒçŸ­çš„éŸ³é¢‘å†…ç½®è¿›é¡¹ç›®è¿›è¡Œæµ‹è¯•</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">-(<span class="keyword">void</span>)audioMergeClick&#123;</span><br><span class="line">    <span class="comment">//1.è·å–æœ¬åœ°éŸ³é¢‘ç´ æ</span></span><br><span class="line">    <span class="built_in">NSString</span> *audioPath1 = [[<span class="built_in">NSBundle</span> mainBundle]pathForResource:<span class="string">@&quot;1&quot;</span> ofType:<span class="string">@&quot;mp3&quot;</span>];</span><br><span class="line">    <span class="built_in">NSString</span> *audioPath2 = [[<span class="built_in">NSBundle</span> mainBundle]pathForResource:<span class="string">@&quot;2&quot;</span> ofType:<span class="string">@&quot;mp3&quot;</span>];</span><br><span class="line">    <span class="built_in">AVURLAsset</span> *audioAsset1 = [<span class="built_in">AVURLAsset</span> assetWithURL:[<span class="built_in">NSURL</span> fileURLWithPath:audioPath1]];</span><br><span class="line">    <span class="built_in">AVURLAsset</span> *audioAsset2 = [<span class="built_in">AVURLAsset</span> assetWithURL:[<span class="built_in">NSURL</span> fileURLWithPath:audioPath2]];</span><br><span class="line">    <span class="comment">//2.åˆ›å»ºä¸¤ä¸ªéŸ³é¢‘è½¨é“,å¹¶è·å–ä¸¤ä¸ªéŸ³é¢‘ç´ æçš„è½¨é“</span></span><br><span class="line">    <span class="built_in">AVMutableComposition</span> *composition = [<span class="built_in">AVMutableComposition</span> composition];</span><br><span class="line">    <span class="comment">//éŸ³é¢‘è½¨é“</span></span><br><span class="line">    <span class="built_in">AVMutableCompositionTrack</span> *audioTrack1 = [composition addMutableTrackWithMediaType:<span class="built_in">AVMediaTypeAudio</span> preferredTrackID:<span class="number">0</span>];</span><br><span class="line">    <span class="built_in">AVMutableCompositionTrack</span> *audioTrack2 = [composition addMutableTrackWithMediaType:<span class="built_in">AVMediaTypeAudio</span> preferredTrackID:<span class="number">0</span>];</span><br><span class="line">    <span class="comment">//è·å–éŸ³é¢‘ç´ æè½¨é“</span></span><br><span class="line">    <span class="built_in">AVAssetTrack</span> *audioAssetTrack1 = [[audioAsset1 tracksWithMediaType:<span class="built_in">AVMediaTypeAudio</span>] firstObject];</span><br><span class="line">    <span class="built_in">AVAssetTrack</span> *audioAssetTrack2 = [[audioAsset2 tracksWithMediaType:<span class="built_in">AVMediaTypeAudio</span>]firstObject];</span><br><span class="line">    <span class="comment">//3.å°†ä¸¤æ®µéŸ³é¢‘æ’å…¥éŸ³è½¨æ–‡ä»¶,è¿›è¡Œåˆå¹¶</span></span><br><span class="line">    <span class="comment">//éŸ³é¢‘åˆå¹¶- æ’å…¥éŸ³è½¨æ–‡ä»¶</span></span><br><span class="line">    <span class="comment">// `startTime`å‚æ•°è¦è®¾ç½®ä¸ºç¬¬ä¸€æ®µéŸ³é¢‘çš„æ—¶é•¿ï¼Œå³`audioAsset1.duration`, è¡¨ç¤ºå°†ç¬¬äºŒæ®µéŸ³é¢‘æ’å…¥åˆ°ç¬¬ä¸€æ®µéŸ³é¢‘çš„å°¾éƒ¨ã€‚</span></span><br><span class="line">    </span><br><span class="line">    [audioTrack1 insertTimeRange:<span class="built_in">CMTimeRangeMake</span>(kCMTimeZero, audioAsset1.duration) ofTrack:audioAssetTrack1 atTime:kCMTimeZero error:<span class="literal">nil</span>];</span><br><span class="line">    [audioTrack2 insertTimeRange:<span class="built_in">CMTimeRangeMake</span>(kCMTimeZero, audioAsset2.duration) ofTrack:audioAssetTrack2 atTime:audioAsset1.duration error:<span class="literal">nil</span>];</span><br><span class="line">    <span class="comment">//4. å¯¼å‡ºåˆå¹¶åçš„éŸ³é¢‘æ–‡ä»¶</span></span><br><span class="line">    <span class="comment">//`presetName`è¦å’Œä¹‹åçš„`session.outputFileType`ç›¸å¯¹åº”</span></span><br><span class="line">    <span class="comment">//éŸ³é¢‘æ–‡ä»¶ç›®å‰åªæ‰¾åˆ°æ”¯æŒm4a ç±»å‹çš„</span></span><br><span class="line">    <span class="built_in">AVAssetExportSession</span> *session = [[<span class="built_in">AVAssetExportSession</span> alloc]initWithAsset:composition presetName:<span class="built_in">AVAssetExportPresetAppleM4A</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSString</span> *outPutFilePath = [[<span class="keyword">self</span>.filePath stringByDeletingLastPathComponent] stringByAppendingPathComponent:<span class="string">@&quot;test.m4a&quot;</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ([[<span class="built_in">NSFileManager</span> defaultManager] fileExistsAtPath:outPutFilePath]) &#123;</span><br><span class="line">        [[<span class="built_in">NSFileManager</span> defaultManager] removeItemAtPath:outPutFilePath error:<span class="literal">nil</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æŸ¥çœ‹å½“å‰sessionæ”¯æŒçš„fileTypeç±»å‹</span></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;---%@&quot;</span>,[session supportedFileTypes]);</span><br><span class="line">    session.outputURL = [<span class="built_in">NSURL</span> fileURLWithPath:<span class="keyword">self</span>.filePath];</span><br><span class="line">    session.outputFileType = <span class="built_in">AVFileTypeAppleM4A</span>; <span class="comment">//ä¸ä¸Šè¿°çš„`present`ç›¸å¯¹åº”</span></span><br><span class="line">    session.shouldOptimizeForNetworkUse = <span class="literal">YES</span>;   <span class="comment">//ä¼˜åŒ–ç½‘ç»œ</span></span><br><span class="line">    [session exportAsynchronouslyWithCompletionHandler:^&#123;</span><br><span class="line">        <span class="keyword">if</span> (session.status == <span class="built_in">AVAssetExportSessionStatusCompleted</span>) &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@&quot;åˆå¹¶æˆåŠŸ----%@&quot;</span>, outPutFilePath);</span><br><span class="line">            UNNotificationSound * sound = [UNNotificationSound soundNamed:<span class="string">@&quot;test.m4a&quot;</span>];</span><br><span class="line">            <span class="keyword">self</span>.bestAttemptContent.sound = sound;</span><br><span class="line">            <span class="keyword">self</span>.contentHandler(<span class="keyword">self</span>.bestAttemptContent);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">self</span>.contentHandler(<span class="keyword">self</span>.bestAttemptContent);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åï¼Œæ¨é€è¿‡æ¥åæ’­æŠ¥çš„è¿˜æ˜¯é»˜è®¤å£°éŸ³ğŸ˜³ï¼Œäºæ˜¯å¼€å§‹æ‰¾åŸå› ï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯æ–‡ä»¶æ ¼å¼çš„é—®é¢˜ï¼Œäºæ˜¯æŠŠ<code>m4a</code>è½¬åŒ–æˆ<code>mp3</code>(çœç•¥ä»£ç )ï¼Œè¿˜æ˜¯ä¸è¡Œï¼Œæœ€åæ‰¾åˆ°äº†ä¸€ç‰‡æ–‡ç« ï¼ˆæ„Ÿè°¢å¤§ä½¬ï¼‰ï¼Œæ–‡ç« è¯´<code>sound</code>è¯»å–æœ¬åœ°éŸ³é¢‘ä¸æ˜¯æ‰€æœ‰è·¯å¾„éƒ½å¯ä»¥ï¼Œæ˜¯æœ‰ä¼˜å…ˆçº§çš„</p>
<ol>
<li>ä¸»åº”ç”¨ä¸­çš„æ–‡ä»¶å¤¹</li>
<li>AppGroupså…±äº«ç›®å½•ä¸­çš„Library/Soundsæ–‡ä»¶å¤¹</li>
<li>main bundle</li>
</ol>
<p>æ ¹æ®è¿™ä¸ªè¯´æ³•æˆ‘å¼€å§‹æµ‹è¯•ï¼Œé¦–å…ˆæ˜¯ç¬¬ä¸€æ¡ï¼Œæˆ‘æ‰“å°å‡ºAPPæ²™ç›’<code>Library</code>ä¸‹æ‰€æœ‰ç›®å½•</p>
<ul>
<li>Library/Sounds<br>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://upload-images.jianshu.io/upload_images/2334192-c3802d151760f3cb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"
                      alt="image"
                ><br>
çœ‹åˆ°é‡Œè¾¹çš„<code>Sounds</code>ç›®å½•äº†å§ï¼Œè¿™æ˜¯æˆ‘åˆ›å»ºçš„ï¼Œä¹‹å‰å¹¶æ²¡æœ‰ï¼Œç„¶åä¿®æ”¹åˆæˆæ–‡ä»¶çš„ä¿å­˜è·¯å¾„ï¼Œé‡æ–°èµ°èµ·ï¼</li>
</ul>
<p>é¢ï¼Œä¾ç„¶æ’­æŠ¥çš„æ˜¯ç³»ç»Ÿé»˜è®¤å£°éŸ³ï¼ŒçŸ­æ—¶é—´å†…æ²¡æ‰¾åˆ°åŸå› ï¼Œäºæ˜¯ç›´æ¥çœ‹ç¬¬äºŒä¼˜å…ˆçº§</p>
<ul>
<li>AppGroups</li>
</ul>
<p>æˆ‘ä»¬çŸ¥é“å› ä¸ºæ²™ç›’æœºåˆ¶ï¼ŒiOSç³»ç»Ÿçš„Appåªèƒ½è®¿é—®è‡ªå·±çš„æ–‡ä»¶å¤¹ï¼Œ<code>AppGroups</code>å°±æ˜¯è‹¹æœæä¾›çš„åŒä¸€å¼€å‘è€…è´¦å·ä¸‹å¤šAppèµ„æºå…±äº«çš„ä¸€ç§æ–¹æ¡ˆï¼Œæœ€ä½æ”¯æŒ<code>iOS8</code>ï¼Œæˆ‘ä»¬ç”¨çš„æ˜¯ä¼ä¸šç­¾åï¼Œå› ä¸ºå…¬å¸ç»„ç»‡æ¶æ„å’Œæƒé™çš„åŸå› éº»çƒ¦äº†ä¸€å¤©æ‰æŠŠä¸€ä¸ªç®€å•<code>AppGroups</code>é…ç½®å®ŒæˆğŸ˜­ï¼Œè¿™é‡Œå°±ä¸è´´å…·ä½“çš„åˆ›å»ºå’Œé…ç½®è¿‡ç¨‹äº†ï¼Œç½‘ä¸Šç›¸å…³çš„èµ„æ–™ä¹Ÿå¾ˆå¤šäº†</p>
<p>æœ€ç»ˆå°†ä¸Šè¾¹çš„éŸ³é¢‘æ–‡ä»¶å¯¼å‡ºè·¯å¾„ä¿®æ”¹ä¸º<code>AppGroups</code>ä¸‹çš„<code>Library/Sounds</code></p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[session exportAsynchronouslyWithCompletionHandler:^&#123;</span><br><span class="line">    <span class="keyword">if</span> (session.status == <span class="built_in">AVAssetExportSessionStatusCompleted</span>) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@&quot;åˆå¹¶æˆåŠŸ----%@&quot;</span>, outPutFilePath);</span><br><span class="line">        UNNotificationSound * sound = [UNNotificationSound soundNamed:<span class="string">@&quot;test.m4a&quot;</span>];</span><br><span class="line">        <span class="keyword">self</span>.bestAttemptContent.sound = sound;</span><br><span class="line">        <span class="keyword">self</span>.contentHandler(<span class="keyword">self</span>.bestAttemptContent);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.contentHandler(<span class="keyword">self</span>.bestAttemptContent);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<p>è®°å¾—åˆ¤æ–­æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨ï¼Œæˆ‘è¿™é‡Œç®€å•è´´ä¸€ä¸‹<code>AppGroups</code>çš„æ“ä½œå§</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSURL</span> *groupURL = [[<span class="built_in">NSFileManager</span> defaultManager] containerURLForSecurityApplicationGroupIdentifier:kGroupDefaultSuiteName];</span><br><span class="line">    <span class="built_in">NSURL</span> * sounds = [groupURL URLByAppendingPathComponent:<span class="string">@&quot;/Library/Sounds/&quot;</span> isDirectory:<span class="literal">YES</span>];</span><br><span class="line">    <span class="keyword">if</span> (![[<span class="built_in">NSFileManager</span> defaultManager] contentsOfDirectoryAtPath:sounds.path error:<span class="literal">nil</span>]) &#123;</span><br><span class="line">        [[<span class="built_in">NSFileManager</span> defaultManager] createDirectoryAtPath:sounds.path withIntermediateDirectories:<span class="literal">YES</span> attributes:<span class="literal">nil</span> error:<span class="literal">nil</span>];</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>æœ€ç»ˆï¼Œå‘èµ·æ¨é€ï¼Œæ’­æŠ¥æˆåŠŸï¼Œä½†è¿™ä¸ªæ–¹æ¡ˆäº§å“è™½ç„¶è¯´å¯ä»¥ä½†è¿˜æ˜¯ä¸å¤ªæ»¡æ„ï¼Œäºæ˜¯ï¼Œç»§ç»­æ‘¸ç´¢</p>
<h3 id="æœ€ç»ˆæ–¹æ¡ˆ">æœ€ç»ˆæ–¹æ¡ˆ</h3>
<p>é‚£ä¹ˆæ€»ç»“ä¸‹ä¹‹å‰æ–¹æ¡ˆä¸è¡Œçš„åŸå› ï¼š</p>
<ul>
<li>ç›´æ¥è¯­éŸ³è½¬æ–‡å­—æ’­æŠ¥ï¼Œç³»ç»Ÿé™åˆ¶iOS12.1åæ’­æŠ¥èƒ½åŠ›</li>
<li>å›ºå®šéŸ³é¢‘ï¼Œä¸å¤Ÿçµæ´»äº§å“ä¸æ»¡æ„</li>
<li>æ‹†åˆ†å›ºå®šéŸ³é¢‘ï¼Œæ‹¼æ¥åæ’­æŠ¥ï¼ˆåŒä¸Šï¼‰</li>
</ul>
<p>æ—¢ç„¶è¿™æ ·ï¼Œèƒ½ä¸èƒ½æŠŠä¸Šè¾¹å‡ ç§æ–¹æ¡ˆçš„ä¼˜ç‚¹ç»“åˆä¸‹ï¼Ÿå°†æ–‡å­—è½¬è¯­éŸ³åçš„éŸ³é¢‘æ–‡ä»¶å­˜åˆ°æœ¬åœ°ç„¶åå†å»æ’­æŠ¥ï¼Ÿè¿™é‡Œå¾—åˆ°äº†å¦ä¸€ä¸ªå¤§ä½¬çš„æŒ‡ç‚¹ï¼ˆæ„Ÿè°¢å¤§ä½¬ï¼‰ï¼Œå°è¯•è¿‡åç¡®è®¤æ–¹æ¡ˆå¯è¡Œâ˜ºï¸</p>
<p>æŸ¥çœ‹äº†<code>AVSpeechSynthesizer</code>æ–‡æ¡£åæ²¡æ‰¾åˆ°è½¬éŸ³é¢‘æ–‡ä»¶çš„ç›¸å…³æ–¹æ³•ï¼ˆå¯èƒ½æ˜¯æˆ‘çœ¼æ‹™ï¼Œæ‰¾åˆ°çš„è¯·å‘Šè¯‰æˆ‘ï¼‰äºæ˜¯å»çœ‹äº†ä¸‰æ–¹çš„èƒ½åŠ›ï¼Œå…¶ä¸­ç™¾åº¦å’Œç§‘å¤§è®¯é£çš„ç¦»çº¿åˆæˆéƒ½æä¾›äº†è·å–éŸ³é¢‘æ–‡ä»¶çš„æ–¹æ³•ï¼Œä½†æ˜¯æœ€ç»ˆæˆ‘ç”¨çš„æ˜¯ç§‘å¤§è®¯é£çš„ï¼Œå› ä¸ºç™¾åº¦çš„åªæä¾›ä¸¤ä¸ªè®¾å¤‡ç ä¾›æµ‹è¯•ï¼Œç§‘å¤§è®¯é£çš„åä¸ªï¼ˆæ ¼å±€æ‰“å¼€ï¼‰</p>
<p>è¯¦ç»†æ–¹æ³•çœ‹<a class="link"   target="_blank" rel="noopener" href="https://www.xfyun.cn/doc/tts/offline_tts/iOS-SDK.html#_3%E3%80%81%E5%9C%A8%E7%BA%BF%E5%90%88%E6%88%90" >ç§‘å¤§è®¯é£<i class="fas fa-external-link-alt"></i></a>æ–‡æ¡£ï¼Œæ³¨å†Œç”³è¯·è¿‡ç¨‹æˆ‘è¿™é‡Œå°±ä¸èµ˜è¿°äº†ï¼Œä½†æ˜¯å¦‚æœæƒ³ç”¨ä¸‰æ–¹æœåŠ¡å¼ºçƒˆå»ºè®®å…ˆçœ‹æ–‡æ¡£ï¼ï¼ï¼</p>
<h5 id="1-åˆå§‹åŒ–ç¦»çº¿åˆæˆå¼•æ“">1. åˆå§‹åŒ–ç¦»çº¿åˆæˆå¼•æ“</h5>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è®¯é£</span></span><br><span class="line">  [IFlySetting setLogFile:LVL_ALL];</span><br><span class="line">  [IFlySetting showLogcat:<span class="literal">YES</span>];</span><br><span class="line">  <span class="built_in">NSString</span> *initString = [[<span class="built_in">NSString</span> alloc] initWithFormat:<span class="string">@&quot;appid=%@&quot;</span>, <span class="string">@&quot;ä½ çš„appid&quot;</span>];</span><br><span class="line">  [IFlySpeechUtility createUtility:initString];</span><br></pre></td></tr></table></figure>
<h5 id="2-è®¾ç½®å‚æ•°">2. è®¾ç½®å‚æ•°</h5>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">_iFlySpeechSynthesizer = [IFlySpeechSynthesizer sharedInstance];</span><br><span class="line">  _iFlySpeechSynthesizer.delegate = <span class="keyword">self</span>;</span><br><span class="line">  [[IFlySpeechUtility getUtility] setParameter:<span class="string">@&quot;tts&quot;</span> forKey:[IFlyResourceUtil ENGINE_START]];</span><br><span class="line">  <span class="comment">//è®¾ç½®æœ¬åœ°å¼•æ“ç±»å‹ï¼Œæ™®é€šç‰ˆè®¾ç½®ä¸ºTYPE_LOCALï¼Œé«˜å“è´¨ç‰ˆè®¾ç½®ä¸ºTYPE_LOCAL_XTTS</span></span><br><span class="line">  [_iFlySpeechSynthesizer setParameter:[IFlySpeechConstant TYPE_LOCAL] forKey:[IFlySpeechConstant ENGINE_TYPE]];</span><br><span class="line">  <span class="comment">//è®¾ç½®å‘éŸ³äººä¸ºå°ç‡•</span></span><br><span class="line">  [_iFlySpeechSynthesizer setParameter:<span class="string">@&quot;xiaoyan&quot;</span> forKey:[IFlySpeechConstant VOICE_NAME]];</span><br><span class="line">  <span class="comment">//è·å–ç¦»çº¿è¯­éŸ³åˆæˆå‘éŸ³äººèµ„æºæ–‡ä»¶è·¯å¾„ã€‚ä»¥å‘éŸ³äººå°ç‡•ä¸ºä¾‹ï¼Œè¯·ç¡®ä¿èµ„æºæ–‡ä»¶çš„å­˜åœ¨ã€‚</span></span><br><span class="line">  <span class="built_in">NSString</span> *resPath = [[<span class="built_in">NSBundle</span> mainBundle] pathForResource:<span class="string">@&quot;common&quot;</span> ofType:<span class="string">@&quot;jet&quot;</span>];</span><br><span class="line">  <span class="built_in">NSString</span> *resPath1 = [[<span class="built_in">NSBundle</span> mainBundle] pathForResource:<span class="string">@&quot;xiaoyan&quot;</span> ofType:<span class="string">@&quot;jet&quot;</span>];</span><br><span class="line">  <span class="built_in">NSString</span> *vcnResPath = [[<span class="built_in">NSString</span> alloc] initWithFormat:<span class="string">@&quot;%@;%@&quot;</span>,resPath,resPath1];</span><br><span class="line">  <span class="comment">//è®¾ç½®ç¦»çº¿è¯­éŸ³åˆæˆå‘éŸ³äººèµ„æºæ–‡ä»¶è·¯å¾„</span></span><br><span class="line">  [_iFlySpeechSynthesizer setParameter:vcnResPath forKey:<span class="string">@&quot;tts_res_path&quot;</span>];</span><br><span class="line">  [_iFlySpeechSynthesizer synthesize:content toUri:[<span class="keyword">self</span> pcmPath]];</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­<code>-(void)synthesize:(NSString *)text toUri:(NSString*)uri</code>æ–¹æ³•å°±æ˜¯ç¦»çº¿åˆæˆåè®²è¯­éŸ³æ–‡ä»¶ä¿å­˜æœ¬åœ°çš„æ–¹æ³•ï¼Œä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯è¦æ’­æŠ¥çš„æ–‡å­—å†…å®¹ï¼Œç¬¬äºŒä¸ªæ˜¯éŸ³é¢‘æ–‡ä»¶è¦å­˜å‚¨çš„è·¯å¾„</p>
<h5 id="3-è·å–æœ¬åœ°éŸ³é¢‘">3. è·å–æœ¬åœ°éŸ³é¢‘</h5>
<p>è¿™è¾¹æœ‰ä¸ªé—®é¢˜å°±æ˜¯ç¦»çº¿åˆæˆçš„è¯­éŸ³æ–‡ä»¶æ˜¯<code>pcm</code>æ ¼å¼çš„ï¼Œä¸ä»…æ˜¯è®¯é£ï¼Œç™¾åº¦ä¹Ÿæ˜¯ä¸€æ ·ï¼Œ<code>pcm</code>æˆ‘ä»¬æ˜¯ä¸èƒ½ç›´æ¥ç»™<code>sound</code>æ’­æ”¾çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åšä¸€ä¸ªæ ¼å¼è½¬æ¢ï¼Œè½¬æˆ<code>mp3</code>è¿›è¡Œæ’­æ”¾ï¼Œè´´ä¸€ä¸ªpcmè½¬mp3æ–¹æ³•ï¼Œéœ€è¦ç”¨çš„<code>lame</code>ä¸‰æ–¹åº“</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * pcm æ–‡ä»¶è½¬mp3æ–‡ä»¶</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)convertPcm:(<span class="built_in">NSString</span> *)pcmPath toMp3:(<span class="built_in">NSString</span> *)mp3Path &#123;</span><br><span class="line">    <span class="keyword">@try</span> &#123;</span><br><span class="line">        FILE *fpcm = fopen([pcmPath cStringUsingEncoding:<span class="built_in">NSASCIIStringEncoding</span>], <span class="string">&quot;rb&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (fpcm == <span class="literal">NULL</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        fseek(fpcm, 1024*4, SEEK_CUR); //è·³è¿‡æºæ–‡ä»¶çš„ä¿¡æ¯å¤´ï¼Œä¸ç„¶åœ¨å¼€å¤´ä¼šæœ‰çˆ†ç ´éŸ³</span></span><br><span class="line">        FILE *fmp3 = fopen([mp3Path cStringUsingEncoding:<span class="built_in">NSASCIIStringEncoding</span>], <span class="string">&quot;wb&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> channelCount = <span class="number">1</span>;   <span class="comment">// å£°é“æ•°, è·Ÿå½•éŸ³æ—¶é…ç½®ä¸€æ ·çš„</span></span><br><span class="line">        lame_t lame = lame_init();</span><br><span class="line">        lame_set_in_samplerate(lame, <span class="number">16000</span>); <span class="comment">//è®¾ç½®é‡‡æ ·ç‡, éœ€è¦è·Ÿå½•éŸ³æ—¶çš„é‡‡æ ·ç‡ç›¸åŒ</span></span><br><span class="line">        lame_set_num_channels(lame, channelCount); <span class="comment">//å£°é“ï¼Œä¸è®¾ç½®é»˜è®¤ä¸ºåŒå£°é“</span></span><br><span class="line">        lame_set_VBR(lame, vbr_default);</span><br><span class="line"><span class="comment">//        lame_set_mode(lame, 0);//è®¾ç½®æœ€ç»ˆmp3ç¼–ç è¾“å‡ºçš„å£°é“æ¨¡å¼ï¼Œå¦‚æœä¸è®¾ç½®åˆ™å’Œè¾“å…¥å£°é“æ•°ä¸€æ ·ã€‚å‚æ•°æ˜¯æšä¸¾ï¼ŒSTEREOä»£è¡¨åŒå£°é“ï¼ŒMONOä»£è¡¨å•å£°é“</span></span><br><span class="line">        lame_set_quality(lame, <span class="number">2</span>);<span class="comment">//è®¾ç½®å‹ç¼©å“è´¨ï¼Œquality=0..9. 0=best (very slow). 9=worst. å“è´¨è¶Šå¥½è½¬ç é€Ÿåº¦è¶Šæ…¢</span></span><br><span class="line">        lame_init_params(lame);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">int</span> PCM_SIZE = <span class="number">8192</span>;<span class="comment">//</span></span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">int</span> <span class="built_in">MP3_SIZE</span> = <span class="number">8192</span>; <span class="comment">//</span></span><br><span class="line">        <span class="keyword">short</span> <span class="keyword">int</span> pcm_buffer[PCM_SIZE*channelCount];</span><br><span class="line">        <span class="keyword">unsigned</span> <span class="keyword">char</span> mp3_buffer[<span class="built_in">MP3_SIZE</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> read;</span><br><span class="line">        <span class="keyword">int</span> write;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            read = fread(pcm_buffer, channelCount*<span class="keyword">sizeof</span>(<span class="keyword">short</span> <span class="keyword">int</span>), PCM_SIZE, fpcm);</span><br><span class="line">            <span class="keyword">if</span> (read == <span class="number">0</span>) &#123;</span><br><span class="line">                write = lame_encode_flush(lame, mp3_buffer, <span class="built_in">MP3_SIZE</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (channelCount == <span class="number">1</span>) &#123;</span><br><span class="line">                    write = lame_encode_buffer(lame, pcm_buffer, <span class="literal">NULL</span>, read, mp3_buffer, <span class="built_in">MP3_SIZE</span>); <span class="comment">// å•å£°é“éŸ³é¢‘è½¬ç </span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    write = lame_encode_buffer_interleaved(lame, pcm_buffer, read, mp3_buffer, <span class="built_in">MP3_SIZE</span>); <span class="comment">// å¤šå£°é“éŸ³é¢‘è½¬ç </span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            fwrite(mp3_buffer, write, <span class="number">1</span>, fmp3);</span><br><span class="line">        &#125; <span class="keyword">while</span> (read != <span class="number">0</span>);</span><br><span class="line">        lame_mp3_tags_fid(lame, fmp3);</span><br><span class="line">        lame_close(lame);</span><br><span class="line">        fclose(fmp3);</span><br><span class="line">        fclose(fpcm);</span><br><span class="line">    &#125; <span class="keyword">@catch</span> (<span class="built_in">NSException</span> *exception) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@&quot;catch exception, %@&quot;</span>, exception);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125; <span class="keyword">@finally</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ€ååœ¨åˆæˆå®Œæˆæ–¹æ³•ä¸­åšè½¬æ¢å’Œæ’­æŠ¥å¤„ç†</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>) onCompleted:(IFlySpeechError *) error &#123;</span><br><span class="line">    <span class="keyword">if</span> (error.errorCode == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">NSURL</span> *groupURL = [[<span class="built_in">NSFileManager</span> defaultManager] containerURLForSecurityApplicationGroupIdentifier:kGroupDefaultSuiteName];</span><br><span class="line">        <span class="built_in">NSURL</span> * sounds = [groupURL URLByAppendingPathComponent:<span class="string">@&quot;/Library/Sounds/&quot;</span> isDirectory:<span class="literal">YES</span>];</span><br><span class="line">        <span class="keyword">if</span> (![[<span class="built_in">NSFileManager</span> defaultManager] contentsOfDirectoryAtPath:sounds.path error:<span class="literal">nil</span>]) &#123;</span><br><span class="line">            [[<span class="built_in">NSFileManager</span> defaultManager] createDirectoryAtPath:sounds.path withIntermediateDirectories:<span class="literal">YES</span> attributes:<span class="literal">nil</span> error:<span class="literal">nil</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">NSURL</span> *mp3Path = [groupURL URLByAppendingPathComponent:<span class="string">@&quot;Library/Sounds/voice.mp3&quot;</span> isDirectory:<span class="literal">NO</span>];</span><br><span class="line">        <span class="built_in">BOOL</span> result = [<span class="keyword">self</span> convertPcm:[<span class="keyword">self</span> pcmPath] toMp3:mp3Path.path];</span><br><span class="line">        <span class="keyword">if</span> (result) &#123;</span><br><span class="line">            <span class="keyword">if</span> (@available(iOS <span class="number">12.1</span>,*)) &#123;</span><br><span class="line">                UNNotificationSound * sound = [UNNotificationSound soundNamed:<span class="string">@&quot;voice.mp3&quot;</span>];</span><br><span class="line">                <span class="keyword">self</span>.bestAttemptContent.sound = sound;</span><br><span class="line">                <span class="keyword">self</span>.contentHandler(<span class="keyword">self</span>.bestAttemptContent);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                _player = [[<span class="built_in">AVAudioPlayer</span> alloc] initWithContentsOfURL:mp3Path error:<span class="literal">nil</span>];</span><br><span class="line">                [_player play];</span><br><span class="line">                <span class="keyword">self</span>.contentHandler(<span class="keyword">self</span>.bestAttemptContent);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">self</span>.contentHandler(<span class="keyword">self</span>.bestAttemptContent);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">self</span>.contentHandler(<span class="keyword">self</span>.bestAttemptContent);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œä¾ç„¶åšäº†ç³»ç»ŸåŒºåˆ†ï¼Œå› ä¸ºå®é™…æµ‹è¯•åå‘ç°ï¼ŒiOS11çš„ç³»ç»Ÿè®¾ç½®åˆæˆéŸ³é¢‘ç»™<code>sound</code>åè¿˜æ˜¯æ’­æ”¾çš„é»˜è®¤å£°éŸ³ï¼Œåæ¥å‘ç°æœ‰äººé‡åˆ°ç±»ä¼¼çš„é—®é¢˜ï¼ŒiOS10-iOS12ç³»ç»Ÿæ— æ³•åœ¨æ¨é€æ‰©å±•é‡Œè¯»å–åˆ°<code>AppGroups</code>ä¸­çš„éŸ³é¢‘æ–‡ä»¶ï¼Œä¹‹å‰æ‰‹è¾¹åªæœ‰iOS15ç³»ç»Ÿçš„æµ‹è¯•æœºï¼Œæ²¡æœ‰å‘ç°è¿™ä¸ªé—®é¢˜ï¼Œæ‰€ä»¥æœ€ååœ¨ä¾ç„¶åšäº†åŒºåˆ†å¤„ç†ä½ç‰ˆæœ¬ç³»ç»Ÿç”¨<code>AVAudioPlayer</code>æ’­æ”¾åˆæˆéŸ³é¢‘</p>
<h3 id="å®ç°æ€»ç»“">å®ç°æ€»ç»“</h3>
<ol>
<li>åˆ›å»º<code>Notification Service Extension</code>ä»¥å®ç°å¯¹æ¨é€æ¶ˆæ¯åšæœ€åçš„ä¿®æ”¹</li>
<li>æ·»åŠ <code>AppGroup</code></li>
<li>å°†è¦æ’­æŠ¥çš„æ–‡å­—å†…å®¹ç”¨ç¦»çº¿åˆæˆè½¬æˆéŸ³é¢‘æ–‡ä»¶å¹¶å­˜å…¥<code>AppGroup</code>å†…çš„<code>/Library/Sounds</code>ä¸‹</li>
<li>ä¿®æ”¹<code>bestAttemptContent</code>çš„<code>sound</code>ä¸ºå­˜å…¥æœ¬åœ°çš„éŸ³é¢‘æ–‡ä»¶</li>
</ol>
<p>è™½ç„¶å®ç°è¿™ä¸ªéœ€æ±‚åºŸäº†äº›æ—¶é—´ï¼Œä½†æ˜¯å®ç°åå›å¤´çœ‹çœ‹ï¼Œä¹Ÿå°±å‡ æ­¥ğŸ˜‚ğŸ˜‚ğŸ˜‚</p>
<h3 id="æ³¨æ„ç‚¹">æ³¨æ„ç‚¹</h3>
<ul>
<li><code>Extension</code>æ˜¯å•ç‹¬çš„è¿›ç¨‹ï¼Œç¦»çº¿åˆæˆå¼•æ“è¦åœ¨<code>Extension</code>ä¸­å¯åŠ¨</li>
<li><code>Extension</code>å¯åŠ¨ååªæœ‰çº¦30sæ—¶é—´ä¾›ä½ æ“ä½œï¼Œè¶…æ—¶ä¼šæ’­æ”¾é»˜è®¤å£°éŸ³</li>
<li>æ¨é€å†…å®¹è¦æ·»åŠ <code>mutable-content</code>å­—æ®µå¹¶å°†å€¼è®¾ç½®ä¸º<code>true</code></li>
</ul>
<h3 id="å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« </h3>
<p><a class="link"   target="_blank" rel="noopener" href="https://juejin.cn/post/7026905121866924063" >iOSå°æŠ€èƒ½ï¼šæ¶ˆæ¯æ¨é€æ‰©å±•çš„ä½¿ç”¨<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   target="_blank" rel="noopener" href="https://juejin.cn/post/6844904042515152903" >iOS13å¾®ä¿¡æ”¶æ¬¾åˆ°è´¦è¯­éŸ³æé†’å¼€å‘æ€»ç»“<i class="fas fa-external-link-alt"></i></a></p>

        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>æœ¬æ–‡æ ‡é¢˜ï¼šiOS15æ¨é€åå°è¯­éŸ³æ’­æŠ¥æ¢ç´¢</li>
        <li>æœ¬æ–‡ä½œè€…ï¼šLazyloading</li>
        <li>åˆ›å»ºæ—¶é—´ï¼š2021-12-19 14:38:57</li>
        <li>
            æœ¬æ–‡é“¾æ¥ï¼šhttps://lazy.wiki/posts/6fd361a9/
        </li>
        <li>
            ç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box">
                
                    <li class="tag-item">
                        <a href="/tags/iOS/">#iOS</a>&nbsp;
                    </li>
                
            </ul>
        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/posts/ed9ccb24/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Homebrew å®‰è£…Mysqlå¯†ç å¿˜è®°è§£å†³</span>
                                <span class="post-nav-item">ä¸Šä¸€ç¯‡</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/posts/9bd452f5/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">åˆè¯†Flutteræ€»ç»“</span>
                                <span class="post-nav-item">ä¸‹ä¸€ç¯‡</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2019</span>
              -
            
            2022&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">Lazyloading</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        è®¿é—®äººæ•°&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
            </div>
        
        <div class="theme-info info-item">
            ç”± <a target="_blank" href="https://hexo.io">Hexo</a> é©±åŠ¨&nbsp;|&nbsp;ä¸»é¢˜&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.5</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">å‰è¨€</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Notification-Service-Extension"><span class="nav-number">2.</span> <span class="nav-text">Notification Service Extension</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%92%AD%E6%8A%A5%E6%8E%A2%E7%B4%A2"><span class="nav-number">3.</span> <span class="nav-text">æ’­æŠ¥æ¢ç´¢</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E8%AF%AD%E9%9F%B3%E5%90%88%E6%88%90"><span class="nav-number">3.1.</span> <span class="nav-text">ç³»ç»Ÿè¯­éŸ³åˆæˆ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%86%85%E7%BD%AE%E6%9C%AC%E5%9C%B0%E9%9F%B3%E9%A2%91"><span class="nav-number">3.2.</span> <span class="nav-text">å†…ç½®æœ¬åœ°éŸ³é¢‘</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%80%E7%BB%88%E6%96%B9%E6%A1%88"><span class="nav-number">4.</span> <span class="nav-text">æœ€ç»ˆæ–¹æ¡ˆ</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E5%88%9D%E5%A7%8B%E5%8C%96%E7%A6%BB%E7%BA%BF%E5%90%88%E6%88%90%E5%BC%95%E6%93%8E"><span class="nav-number">4.0.1.</span> <span class="nav-text">1. åˆå§‹åŒ–ç¦»çº¿åˆæˆå¼•æ“</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-%E8%AE%BE%E7%BD%AE%E5%8F%82%E6%95%B0"><span class="nav-number">4.0.2.</span> <span class="nav-text">2. è®¾ç½®å‚æ•°</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-%E8%8E%B7%E5%8F%96%E6%9C%AC%E5%9C%B0%E9%9F%B3%E9%A2%91"><span class="nav-number">4.0.3.</span> <span class="nav-text">3. è·å–æœ¬åœ°éŸ³é¢‘</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E6%80%BB%E7%BB%93"><span class="nav-number">5.</span> <span class="nav-text">å®ç°æ€»ç»“</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%A8%E6%84%8F%E7%82%B9"><span class="nav-number">6.</span> <span class="nav-text">æ³¨æ„ç‚¹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"><span class="nav-number">7.</span> <span class="nav-text">å‚è€ƒæ–‡ç« </span></a></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="æœç´¢..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/dark-light-toggle.js"></script>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/code-copy.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/lazyload.js"></script>


<div class="post-scripts pjax">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/toc.js"></script>
    
</div>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
